extends ../index

append css
  link(rel="stylesheet",href="//cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.css")
  link(rel="stylesheet",href="/components/eonasdan-bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css")

append js
  script(src="//cdn.bootcss.com/moment.js/2.13.0/moment-with-locales.min.js")
  //script(src='/components/bootbox.js/bootbox.js')
  script(src='//cdn.bootcss.com/bootbox.js/4.4.0/bootbox.min.js')
  //script(src='/components/requirejs/require.js',data-main="/js/main")
  script(src="//cdn.bootcss.com/bootstrap-table/1.11.1/bootstrap-table.min.js")
  script(src="//cdn.bootcss.com/bootstrap-table/1.11.1/locale/bootstrap-table-zh-CN.min.js")
  script(src="/components/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js")
  if ENV_DEVELOPMENT
    script(src="//cdn.bootcss.com/vue/2.2.4/vue.js")
  else
    script(src="//cdn.bootcss.com/vue/2.2.4/vue.min.js")
  script(src='/js/member_view.js')

block page
  div#member_app.container(style='padding-top:69px',data-member-id='#{memberID}')
    ol.breadcrumb
      li
        a(href="../home") 主页
      li
        a(href="./") 会员列表
      li.active 查看会员
    div.page-header
      h3 基本信息
    form.form-horizontal
      div.form-group
        label.col-sm-2.control-label 状态:
        select.col-sm-5.form-control(v-model='memberData.status',style='margin-left:15px;width:auto')
          option.text-success(value='active') 激活
          option.text-danger(value='inactive') 未激活
      div.form-group
        label.col-sm-2.control-label 姓名:
        div.col-sm-5
          input.form-control(v-model.trim='memberData.name', placeholder='小朋友姓名')
        div.col-sm-5
          p.form-control-static(style='color:#808080')
            small {{memberData.since | formatDate}}注册会员
      div.form-group
        label.col-sm-2.control-label 联系方式:
        div.col-sm-5
          input.form-control(v-model.trim='memberData.contact', placeholder='135xxx')
      div.form-group
        label.control-label.col-sm-2 宝宝生日:
        div.col-sm-4
          div#birth_date.input-group.date
            input.form-control(text='text')
            span.input-group-addon
              span.glyphicon.glyphicon-calendar
      div.form-group
        label.control-label.col-sm-2 备注:
        div.col-sm-10
          textarea.form-control(rows='3', name='note',v-model.trim='memberData.note')
      div.form-group
        div.col-sm-offset-2.col-sm-10
          button.btn.btn-success(type='button',v-on:click='saveBasicInfo') 保存
          div.alert.alert-danger(style='position:absolute;top:-10px;left:100px;right:15px',v-if='errors')
            strong 错误! 
            |{{errors.basic}} 
    div.page-header
      h3 会员卡
      card(v-for="card in memberData.membership",@save="saveCardInfo",:item='card')
    div.page-header
      h3 备忘
    div.page-header
      h3 充值记录
    div.page-header
      h3 上课记录
  script#card-template(type='text/x-template')
    form.form-horizontal
      div.form-group
        label.control-label.col-sm-2 课时:
        div.col-sm-10
          p.form-control-static {{item.credit}}次(剩余)
      div.form-group
        label.control-label.col-sm-2 增加/减少:
        div.col-sm-10(style="display:inline-flex")
          button.btn.btn-sm.btn-danger(type="button",style="margin:2px;padding:3px",@click="alterCharge(-10)")
            span.glyphicon.glyphicon-minus
            | 10
          button.btn.btn-sm.btn-danger(type="button",style="margin:2px;padding:3px",@click="alterCharge(-1)")
            span.glyphicon.glyphicon-minus
            | 1
          input.form-control(type='number',v-model.number='delta',min='-100',max='100',step='0.1',style="width:85px;margin:0 2px")
          button.btn.btn-sm.btn-success(type="button",style="margin:2px;padding:3px",@click="alterCharge(1)")
            span.glyphicon.glyphicon-plus
            | 1
          button.btn.btn-sm.btn-success(type="button",style="margin:2px;padding:3px",@click="alterCharge(10)")
            span.glyphicon.glyphicon-plus
            | 10
      div.form-group
        label.control-label.col-sm-2 有效期至:
        div.col-sm-4
          div#expire_date.input-group.date
            input.form-control(text='text',:value='displayExpireDay(item.expire)',@change='setExpireDay')
            span.input-group-addon
              span.glyphicon.glyphicon-calendar
      div.form-group
        label.control-label.col-sm-2 类型:
        div.col-sm-4
          select.form-control(name="card_type",v-model='item.type')
            option(value='ALL') 通用卡
            option(value='LIMITED') 限定卡
      div.form-group
        label.control-label.col-sm-2 可用教室:
        div#roomlist.col-sm-10
          - each room in classroom
            div.checkbox
              label
                input(type="checkbox", value=room.id,v-model='item.room')
                = room.name
      div.form-group
        div.col-sm-offset-2.col-sm-10
          button.btn.btn-success(type='button',v-on:click='$emit("save", item)') 保存
          div.alert.alert-danger(style='position:absolute;top:-10px;left:100px;right:15px',v-if='errors')
            strong 错误! 
            |{{errors.card}}